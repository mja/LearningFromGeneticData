---
title: Genetics of common complex psychiatric disorders I
author: Mark James Adams
format: 
  revealjs:
    embed-resources: true
    self-contained-math: true
  pdf: default
execute:
  warning: false
  message: false
--- 

# Part 1: Biometrics

Mark James Adams  
Division of Psychiatry  
`mark.adams@ed.ac.uk`  
*Genetics and Environmental Influences on Behaviour and Mental Health*

```{r plotting}
#| echo: false

# font size for plotting
base_size <- function() {
  size = 12
  if (knitr::is_html_output()) {
    size = 16
  } else if (knitr::is_latex_output()) {
    size = 10
  }
  size
}
```

# What is a *"common"*, *"complex"* psychiatric disorder?

**Common:** Affects 1% or more of the population  
**Complex:** Inheritance cannot be explained by a single gene  

::: {.notes}
Psychiatric disorders are defined by disruption to higher-order brain functions of moods, perceptions, thoughts, beliefs, and behaviours but usually in the absence of major neurological impairments (consciousness, senses, memory). Psychiatric disorders include depressive and anxiety disorders (major depressive disorder, panic disorder), manic and psychotic disorders (bipolar disorder, schizophrenia), obsessive-compulsive disorders, eating disorders (anorexia nervosa, bulimia nervosa), substance-use disorders and personality disorders. Childhood conditions like attention-deficit/hyperactivity and autism can also be included, but only when they lead to clinically-salient impairment or distress. There are also many shades of sadness, hallucinations, eccentricities, mood swings, body-image preoccupations, recreational substances use, personalities, etc that are not psychiatric disorders but may still be informative to study from an aetiological and genetic standpoint.

- Sullivan PF and Geschwind DH (2019) [Defining the Genetic, Genomic, Cellular, and Diagnostic Architectures of Psychiatric Disorders](https://doi.org/10.1016/j.cell.2019.01.015). *Cell* doi:10.1016/j.cell.2019.01.015

:::

## Psychiatric diagnoses {.smaller}

- Depressive disorder: Marked and persistent low mood and inability to feel pleasure.
- Anxiety disorder: Extensive, pervasive, unrealistic, and disabling worry.
- Bipolar disorder: Intense mood swings between mania and depression.
- Schizophrenia: Peristent hallucinations and delusions that severely impair functioning, highly disorganised thought and speech.
- Eating disorders: self-starvation or excessive over-eating, debilitating preoccupation with body image. 
- Attention-deficit/hyperactivity disorder: Early onset, developmentally inappropriate and persistant hyperactivity and inattention. 
- Autism spectrum disorders: Markedly impaired interpersonal interactions, non-goal-directed behaviours, and language development.

:::{.notes}
- Sullivan, P. F., Daly, M. J. & O‚ÄôDonovan, M. Genetic architectures of psychiatric disorders: the emerging picture and its implications. Nat Rev Genet 13, 537 551 (2012).
- Frances, A. Essentials of Psychiatric Diagnosis. Guilford Press (2013).
:::
  

## Prevalences

- Depression: 3% in a week
- Schizophrenia: 1% in lifetime
- Bipolar disorder: 2% in lifetime
- Anxiety disorder: 6% in a week

::: {.notes}
Psychiatric disorders have many causes, correlates, and consequences (genetics, environment, family life, substance use, relationships)

Incidence of psychiatric disorders range from the common (depression, anxiety) to the rare (bipolar disorder, schizophrenia). 
:::

# Why genetics?

Why use genetics to study mental health and psychiatric disorders?

- Biological understanding of genes, pathways
- Shared aetiology with other disorders
- Risk prediction
- Drug retargeting
- Causal analysis of environmental risk factors

## Genetics of categorical traits

![Diagram showing the seven "characters" observed by Mendel](assets/Mendel_seven_characters.svg)

::: {.notes}
Gregor Mendel (1822‚Äì1884), working in what is now Czechia, discovered the transmission of traits from parents to offspring could be explained by the inheritance of two "elements", which we now call alleles. Mendel was concerned with discrete or categorical phenotypes.

[Mendel pea plant figure](https://commons.wikimedia.org/wiki/File:Mendel_seven_characters.svg) by Mariana Ruiz (LadyofHats) [public domain]
:::

## Genetics of continuous traits

![](assets/Galton-Regression-PlateIX.png)

::: {.notes}
Separately, Francis Galton (1822‚Äì1911), was studying the inheritance of continuous or metric phenotypes. He noticed the parents who were tall tended to have children that were slightly shorter than themselves (and vice versa). This was termed "regression to the mean" from which the name of the statistical method "regression" is derived. 

> "In their search for universal hereditary laws, Galton and Pearson were driven by the linear model and the normal distribution because the associated parameters had scientific meaning for them that went beyond mere description."
- Wachsmuth, A., Wilkinson, L., & Dallal, G. E. (2003). [Galton's Bend](https://dx.doi.org/10.1198/0003130031874). The American Statistician, 57(3), 190‚Äì192. doi:10.1198/0003130031874

For more on Galton's legacy, see [https://adelphigenetics.org/history/](https://adelphigenetics.org/history/)
:::

## Reconciling categorical + continuous genetics = quantitative genetics

```{r polygenic_quantitative}
#| echo: false
require(ggplot2)
require(dplyr)
require(stringr)

# calculate expected genotype frequency for number of increasing alleles
# use the density of the binomial distribution, for alleles = 0 up to 2 * number of loci. 
# assume each allele has the same frequency of 50% (for simplicity)
n_allele_freq <- function(n_loci) {
  alleles <- seq(from = 0, to = 2*n_loci)
  freq <- dbinom(alleles, size = 2*n_loci, prob = 0.5)
  data.frame(alleles, freq, loci = n_loci)
}

number_of_loci <- c(1, 2, 3, 10)
loci_freq <- bind_rows(lapply(number_of_loci, n_allele_freq))

loci_labeller <- function(string) {
  n_loci <- as.numeric(string)
  if_else(
    n_loci == 1, 
    true = "1 locus",
    false = str_c(string, "loci", sep = " "))
}
plot_loci <- function(loci_freq) {
  ggplot(loci_freq, aes(x = alleles, y = freq)) + geom_col() +
  facet_grid(
    . ~ loci,
    scales = "free_x",
    space = "free_x",
    labeller = labeller(loci = loci_labeller)
  ) +
  scale_x_continuous("Number of phenotype increasing alleles") +
  scale_y_continuous("Genotype frequency") +
  theme_linedraw()
}

plot_loci(
  filter(loci_freq, loci == 1)
)
```

<!-- ![](assets/Fisher-Supposition.png) -->
:::{.notes}
Ronald Fisher reconciled the inheritance of continuous and categorical phenotypes by showing that a continuous phenotype could be made from the inheritance of a large number (dozens, hundreds, or thousands) categorical genes. The term "variance" comes from Fisher's discoveries.

- Fisher, R. A. (1918). [XV.‚ÄîThe correlation between relatives on the supposition of Mendelian inheritance](https://dx.doi.org/10.1017/S0080456800012163). *Transactions of the Royal Society of Edinburgh*. doi:10.1017/S0080456800012163
- Charlesworth and Edwards (2018). [A century of variance](https://doi.org/10.1111/j.1740-9713.2018.01170.x). *Significance* 15(4). doi:10.1111/j.1740-9713.2018.01170.x
- Bodmer et al (2021) [The outstanding scientist, R.A. Fisher: his views on eugenics and race](https://dx.doi.org/10.1038/s41437-020-00394-6). _Heredity_ doi:10.1038/s41437-020-00394-6
:::

## Single locus with additive effect

Single locus with two alleles, $\mathrm{A}_1$ and $\mathrm{A}_2$, and four genotypes with values:

- $\mathrm{A}_1\mathrm{A}_1$: $2a$
- $\mathrm{A}_1\mathrm{A}_2$ and $\mathrm{A}_2\mathrm{A}_1$: $a$
- $\mathrm{A}_2\mathrm{A}_2$: $0$

:::{.notes}
At this locus the $\mathrm{A}_2\mathrm{A}_2$ homozygote is set as the baseline
:::

##

If allele $\mathrm{A}_1$ has a frequency of $p$ and $\mathrm{A}_2$ has frequency $1-p$, then the genotype frequencies are:

- $\mathrm{A}_1\mathrm{A}_1$: $p^2$
- $\mathrm{A}_1\mathrm{A}_2$ and $\mathrm{A}_2\mathrm{A}_1$: $2p(1-p)$
- $\mathrm{A}_2\mathrm{A}_2$: $(1-p^2)$

##

|Genotype                   | Frequency | Value | Freq. $\times$ Val.|
|---------------------------|----------:|------:|-------------------:|
|$\mathrm{A}_1\mathrm{A}_1$ | $p^2$     |$2a$       |$2p^2a$          |
|$\mathrm{A}_1\mathrm{A}_2$ | $p(1-p)$  |$a$        |$p(1-p)a$             |
|$\mathrm{A}_2\mathrm{A}_1$ | $p(1-p)$  |$a$        |$p(1-p)a$             |
|$\mathrm{A}_2\mathrm{A}_2$ | $(1-p)^2$ |$0$        |$0$     |
|                           |           |Mean =     |$2pa$     |
|                           |           |Variance = | $2p(1-p)a^2$   |

:::{.notes}
Table based on Table 7.1, Falconer and Mackay.
:::

## Genetic values

Each individual $i$ has a genetic value at locus $j$: 

$$
g_{ij} \in [0, a_j, 2a_j]
$$

Total genetic value from $M$ loci:

$$
G_i = \sum_{j = 1}^M g_{ij}
$$

$$
\mathrm{var}(G) = \sum_{j = 1}^M 2p_j(1-p_j)a_j^2
$$

## Polygenic traits are quantitative traits

Adding up effects from a large number of genetic loci makes a continuous phenotype.

```{r polygenic_quantitative_10}
#| echo: false
plot_loci(loci_freq)
```

:::{.notes}
> "R. A. Fisher's 1918 paper, 'The correlation between relatives on the supposition of Mendelian inheritance', resolved the often bitter conflict between biometricians and Mendelians, which raged for a decade following the rediscovery of Mendel's work. Fisher showed that a complex quantitative trait could be explained by Mendelian inheritance if several genes affect the trait."
- Plomin, R., Haworth, C. & Davis, O. [Common disorders are quantitative traits](https://dx.doi.org/10.1038/nrg2670). *Nat Rev Genet* **10**, 872-878 (2009). doi:10.1038/nrg2670
:::

# Biometrics

## What are the sources of family resemblance? How do we quantify them numerically?

## Heritability

Proportion of similarity in phenotypes that can be attributed to similarity in genotypes. 

**Model:** Phenotype (P) = Genotype (G) + Environment (E)  
**Variance decomposition**
$$\mathrm{var}(P) = \mathrm{var}(G) + \mathrm{var}(ùê∏)$$

**Proportion of variance**
$$H^2 = \frac{\mathrm{var}(G)}{\mathrm{var}(ùëÉ)}, e^2 = \frac{\mathrm{var}(E)}{\mathrm{var}(ùëÉ)}, H^2 + e^2 = 1$$

:::{.notes}
The effect $G$ denotes all genetic effects ($G = A + D + I$ for additive, dominance, and epistatic variance). In the more limited case where it is assumed genetic effects act only additively (they don't interact with each other), then only additive genetic variance $\mathrm{var}(A)$ is used with (narrow-sense) heritability defined as $h^2 = \frac{\mathrm{var}(A)}{\mathrm{var}(P)}$.

- Tenesa, A., Haley, C. [The heritability of human disease: estimation, uses and abuses](https://dx.doi.org/10.1038/nrg3377). _Nat Rev Genet_ **14**, 139‚Äì149 (2013). doi:10.1038/nrg3377
- Visscher, P., Hill, W. & Wray, N. [Heritability in the genomics era ‚Äî concepts and misconceptions](https://dx.doi.org/10.1038/nrg2322). _Nat Rev Genet_ **9**, 255‚Äì266 (2008). doi:10.1038/nrg2322
:::

## How to estimate heritability from data

```{r}
#| label: height
#| echo: false
require(readr)
require(dplyr)
require(ggplot2)

height_data <- read_tsv(here::here("data/galton-stata11/galton-stata11.tab"))

# filter to one offspring per family
# convert to cm
# average parental height
height_singletons <- height_data |>
  mutate(
    father_cm = father * 2.54,
    mother_cm = mother * 2.54,
    child_cm = height * 2.54
  ) |>
  mutate(parents_cm = (father_cm + mother_cm) / 2) |>
  group_by(family) |>
  slice_head(n = 1)
```

:::: {.columns}

::: {.column width="60%"}
```{r}
#| label: height_parent_offspring
#| fig-width: 5
#| fig-height: 5
#| echo: false
require(ggplot2)

ggplot(height_singletons, aes(x = parents_cm, y = child_cm)) +
  geom_point() +
  scale_x_continuous("Parental height [avg.] (cm)") +
  scale_y_continuous("Child height (cm)")
```
:::

::: {.column width="40%"}
Plot of child (offspring) height versus the average of their parents' heights. What is a statistic that can be used to summarise the relationship between these two variables?
:::

::::

## How to estimate heritability from data

:::: {.columns}

::: {.column width="60%"}
```{r}
#| label: height_parent_offspring_regress
#| fig-width: 5
#| fig-height: 5
#| echo: false
require(ggplot2)

height_parent_offspring_regress_g <- ggplot(height_singletons, aes(x = parents_cm, y = child_cm)) +
  geom_point() +
  stat_smooth(method = "lm", formula = y ~ x, se = FALSE) +
  scale_x_continuous("Parental height [avg.] (cm)") +
  scale_y_continuous("Child height (cm)")
height_parent_offspring_regress_g
```
:::

::: {.column width="40%" .fragment}
$\beta = \frac{\mathrm{cov}(X, Y)}{\mathrm{var}(X)}$

Estimate the beta coefficient (slope) for a simple regression from the covariance between predictor ($X$) and outcome ($Y$) variable divided by the variance of the predictor ($X$).
:::

::::

## Simple model of genetic and environmental effects

$$
P = A + E
$$

The phenotype value $P$ is influenced by an additive genetic effect $A$ and and environmental effect $E$. 

:::{.notes}
For simplicity assume that $P$ is an individual's deviation from the average phenotype in the population.
:::

## Simple model of genomics

$$
A = d + s
$$

Each individual has two copies of the genome, one inherited from each parent. 

:::{.notes}
Here we label the genome from the mother $d$ and the genome from the father $s$. These are the transmitted genetic effects. 
:::

## Simple model of inheritance

![](assets/genetic-model.svg)

:::{.notes}
Each parent also has a copy of the genome which they do not pass on to their child, labelled $d^\prime$ for the mother and $s^\prime$ for the father. These are the non-transmitted genetic effects.
:::

## Simple model of genetics, environment, and inheritance

Phenotype ($P$) value is the sum of the two genetic values plus an environmental value ($e$).

- Mother's phenotype: $P_d = d + d^\prime + e_d$
- Father's phenotype: $P_s = s + s^\prime + e_s$
- Child's phenotype: $P_o = d + s + e_o$

## Regression equation

:::: {.columns}



::: {.column width="60%"}
::: {.content-visible unless-format="pdf"}
```{r}
#| label: height_parent_offspring_regress2
#| fig-width: 5
#| fig-height: 5
#| echo: false
height_parent_offspring_regress_g
```
:::
:::

::: {.column width="40%"}

$\beta = \frac{\mathrm{cov}(X, Y)}{\mathrm{var}(X)}$

- $X$ = average of parents' phenotypes
- $Y$ = offspring phenotype

Therefore, $\beta = \frac{\mathrm{cov}(\frac{P_d + P_s}{2}, P_o)}{\mathrm{var}(\frac{P_d + P_s}{2})}$
:::

::::

## Parent‚Äìoffspring covariance

$$
\mathrm{cov}(\frac{P_d + P_s}{2}, P_o)
$$

$$
= \mathrm{cov}(\frac{d + d^\prime + e_d + s + s^\prime + e_s}{2}, d + s + e_o)
$$

## Parent-offspring covariance

Expand the terms. Recall that:

$$
\mathrm{cov}(A+X,B+Y) = \\
\mathrm{cov}(A,B) + \mathrm{cov}(A,Y) + \mathrm{cov}(X,B) + \mathrm{cov}(X,Y)
$$ 
Thus we can do a pairwise expansion to:
$$
= \mathrm{cov}(\frac{d}{2} + \frac{d^\prime}{2} + \frac{e_d}{2} + \frac{s}{2} + \frac{s^\prime}{2} + \frac{e_s}{2}, d + s + e_o)
$$
$$
= \mathrm{cov}(\frac{d}{2}, d) + \mathrm{cov}(\frac{d^\prime}{2}, d) + \dotsm+ \mathrm{cov}(\frac{e_s}{2}, e_o)
$$

## Simplifications

Some terms can be simplified.

Covariance between a genetic effect and itself
$$
\mathrm{cov}(\frac{d}{2}, d), \mathrm{cov}(\frac{s}{2}, s)
$$

Simplifies to:

$$
\mathrm{cov}(\frac{d}{2}, d) = \frac{1}{2}\mathrm{cov}(d, d) = \frac{1}{2}\mathrm{var}(d)
$$
$$
\mathrm{cov}(\frac{s}{2}, s) = \frac{1}{2}\mathrm{cov}(s, s) = \frac{1}{2}\mathrm{var}(s)
$$

## Assumptions

For some terms we might make an assumption that they are equal to 0.

*Covariance between genetic effects from the same parent*
$$
\mathrm{cov}(\frac{d^\prime}{2}, d), \mathrm{cov}(\frac{s^\prime}{2}, s)
$$

:::{.notes}
If there is inbreeding (individual does not have ancestors that are closely related) or assortative mating in the grandparental generation, then genetic effects from the same parent would be expected to have a non-zero covariance.
:::

*Covariance between genetic effects from different parents*
$$
\mathrm{cov}(\frac{d^\prime}{2}, s), \mathrm{cov}(\frac{s^\prime}{2}, d)
$$

:::{.notes}
If there is assortative mating between the parents, then these effects would be expected to covary
:::

##

*Covariance between parent and offspring environment effects*
$$
\mathrm{cov}(\frac{e_d}{2}, e_o), \mathrm{cov}(\frac{e_s}{2}, e_o)
$$

:::{.notes}
If aspects of the parental environment are transmitted as well or if parents and offspring tend to encounter similar environments, then these effects are expected to covary.
:::

*Covariance between parental genetic and offspring environmental effects*
$$
\mathrm{cov}(\frac{d}{2}, e_o), \mathrm{cov}(\frac{s}{2}, e_o)
$$

:::{.notes}
If parental genetic effects shape the environment of the offspring (referred to as indirect genetic effects), then these effects are expected to covary as well.
:::

##

Using those assumptions the parent‚Äìoffspring covariance simplifies to

$$
\mathrm{cov}(\frac{P_d + P_s}{2}, P_o) = \frac{\mathrm{var}(d) + \mathrm{var}(s)}{2}
$$

## Parent variance

The denominator in the regression equation was
$$
\mathrm{var}(\frac{P_d + P_s}{2})
$$

##

Using the identity
$$
\mathrm{var}(aX + bY) = a^2\mathrm{var}(X) + b^2\mathrm{var}(Y) + 2ab\mathrm{cov}(X, Y)
$$
the variance of the average parental phenotypes is:
$$
\mathrm{var}(\frac{P_d + P_s}{2}) = \mathrm{var}(\frac{1}{2}P_d + \frac{1}{2} P_s)
$$
$$
= \left(\frac{1}{2}\right)^2\mathrm{var}(P_d) + \left(\frac{1}{2}\right)^2\mathrm{var}(P_s) + 2 \cdot \frac{1}{2} \cdot \frac{1}{2} \mathrm{cov}(P_d, P_s)
$$
$$
= \frac{1}{4}\mathrm{var}(P_d) + \frac{1}{4}\mathrm{var}(P_s) + \frac{1}{2} \mathrm{cov}(P_d, P_s)
$$

##

If we assume as above that there is no covariation between parental effects ($\mathrm{cov}(P_d, P_s) = 0$), this simplifies to

$$
= \frac{\mathrm{var}(P_d) + \mathrm{var}(P_s)}{4}
$$

##

Thus the regression equation is:

$$
\beta = \frac{\mathrm{cov}(\frac{P_d + P_s}{2}, P_o)}{\mathrm{var}(\frac{P_d + P_s}{2})} \\
= \frac{\frac{\mathrm{var}(d) + \mathrm{var}(s)}{2}}{\frac{\mathrm{var}(P_d) + \mathrm{var}(P_s)}{4}} \\
= 2\frac{\mathrm{var}(d) + \mathrm{var}(s)}{\mathrm{var}(P_d) + \mathrm{var}(P_s)}
$$

##

Previously we defined

$$
A = d + s
$$
thus
$$
\mathrm{var}(A) = \mathrm{var}(d) + \mathrm{var}(s)
$$
and assume variances in parental phenotypes are equal
$$
\mathrm{var}(P_d) = \mathrm{var}(P_s) = \mathrm{var}(P)
$$

##

Then substitute into the regression equation

$$
\beta = 2\frac{\mathrm{var}(d) + \mathrm{var}(s)}{\mathrm{var}(P_d) + \mathrm{var}(P_s)} \\
= 2 \frac{\mathrm{var}(A)}{\mathrm{var}(P) + \mathrm{var}(P)} \\
= 2 \frac{\mathrm{var}(A)}{2 \mathrm{var}(P)} \\
= \frac{\mathrm{var}(A)}{\mathrm{var}(P)} \\
= h^2
$$

:::{.notes}
In other words, the beta coefficient from the regression of offspring phenotype on average parent phenotype yields an estimate of the heritability!
:::

## Height data

:::{.notes}
Using the height data, we can calculate the mid-parent‚Äìoffspring covariance and mid-parent variance and then use that as an estimate for the heritability.
:::

```{r}
#| label: height_cov_var
#| echo: false
height_parent_child_cov <- round(with(height_singletons, cov(parents_cm, child_cm)), 2)
height_parent_var <- round(with(height_singletons, var(parents_cm)), 2)
```

$\mathrm{cov}(\frac{P_d + P_s}{2}, P_o) =$  `r height_parent_child_cov`  
$\mathrm{var}(\frac{P_d + P_s}{2}) =$  `r height_parent_var`  
$\hat{h}^2 =$  `r height_parent_child_cov` / `r height_parent_var` = `r round(height_parent_child_cov / height_parent_var, 2)`

##

Parent and offspring phenotypes become more highly correlated as heritability increases. 

```{r}
#| label: parent_offspring_h2_sim
#| echo: false
require(ggplot2)
require(dplyr)

set.seed(751889)

# simulate data with different heritabilities
n_sim <- 500
# if phenotypic variance is 1, variance of average parents is 0.5
parents <- rnorm(n_sim, mean = 0, sd = sqrt(0.5))
h2 <- list(0.1, 0.5, 0.9)

sims <- lapply(
  h2,
  function(h2) {
      # simulate children from mid-parent, plus segregation and environment
      # variance
      children <- h2 * parents + rnorm(n_sim, mean = 0, sd = sqrt(1 - h2/2))
      data.frame(parents = parents, children = children, h2 = paste("h^2 =", h2))
  }
)

ggplot(bind_rows(sims), aes(x = parents, y = children)) +
  geom_point() +
  stat_smooth(method = lm, formula = y ~ x, se = FALSE) +
  facet_grid(cols = vars(h2)) +
  scale_x_continuous("mid-parent phenotyic value") +
  scale_y_continuous("offspring phenotypic value") +
  theme_classic()
```



:::{.notes}
Wray, N. & Visscher, P. (2008) [Estimating trait heritability](https://www.nature.com/scitable/topicpage/estimating-trait-heritability-46889/). Nature Education 1(1):29
:::

##

::::{.columns}

:::{.column}

**Mini review: What assumptions have we made when estimating $h^2$?**

:::

:::{.column}

[![](assets/underground.png)]{.content-visible when-format="html"}

:::

::::

:::{.notes}
Parents' environments are not similar: $\mathrm{cov}(e_d, e_s) = 0$  
No assortative mating: $\mathrm{cov}(d, s) = 0$  
Parents do not transmit their environments: $\mathrm{cov}(e_o, e_d) = 0$, $\mathrm{cov}(e_o, e_s) = 0$  
No gene-environment correlation: $\mathrm{cov}(d, e_d) = 0$, $\mathrm{cov}(s, e_s) = 0$  
No genetic nature: $\mathrm{cov}(d, e_o) = 0$, $\mathrm{cov}(s, e_o) = 0$  
No inbreeding: $\mathrm{cov}(d, d^\prime) = 0$, $\mathrm{cov}(s, s^\prime) = 0$  
Genetic effects are additive: $Y = a + a^\prime + e$  
Genetic influence is the same for both sexes: $\mathrm{var}(d + d^\prime) =  var(s + s^\prime)$
:::


## Generalising to other relatives

Heritability can also be estimated from resemblance between different types of related pairs. The general equation is:

::::{.columns}

:::{.column}
$$
h^2 = \frac{b}{\mathrm{r}}
$$

$b$ = regression coefficient  
$\mathrm{r}$ = relatedness coefficient ("coefficient of additive variance")

:::

:::{.column}

![](assets/Coefficient_of_relatedness.png)

:::

::::

:::{.notes}
In this notation we used normal $\mathrm{r}$ to represent relatedness, to disguish it from italic $r$ for correlation coefficient.

Figure [Coefficient of relatedness](https://commons.wikimedia.org/wiki/File:Coefficient_of_relatedness.png) CC-BY-SA Citynoise.
:::

## Example data: depression scores

Correlation of depression scores for different pairs of relatives

```{r}
#| label: amf_depression
#| echo: false
require(readr)
require(dplyr)
require(ggplot2)
require(ggrepel)

depression_dyads <- read_csv(here::here("data/fernandez-pujals-depression/fernandez-pujals-depression.csv"))

ggplot(depression_dyads, aes(x =r, y = b, label = `Relationship dyad`)) +
  geom_point() +
  geom_label_repel() +
  scale_x_continuous(breaks=c(0, 0.125, 0.25, 0.5))
```

:::{.notes}

Fernandez-Pujals AM et al. (2015) Epidemiology and Heritability of Major Depressive Disorder, Stratified by Age of Onset, Sex, and Illness Course in Generation Scotland: Scottish Family Health Study (GS:SFHS). *PLOS ONE* 10(11): e0142197. doi:[10.1371/journal.pone.0142197](https://dx.doi.org/10.1371/journal.pone.0142197)

:::

## Recurrance risk to relatives

$$
\lambda_\mathrm{R} = \frac{P(\mathrm{affected} | \mathrm{relative\ affected})}{P(\mathrm{affected\ in\ population})} = \frac{K_\mathrm{R}}{K}
$$

```{r}
#| label: liability_scz_mdd
#| echo: false
require(dplyr)
require(ggplot2)
require(stringr)

liability_scz_mdd <- tribble(
  ~disorder, ~k,
  "Schizophrenia", 0.01,
  "Major Depressive Disorder", 0.15
)

ggplot(liability_scz_mdd) +
  geom_function(fun = dnorm) +
  stat_function(data = data.frame(disorder="Schizophrenia"), fun = dnorm, geom = "area", xlim = c(qnorm(1 - 0.01), 5), fill = "lightblue") +
  stat_function(data = data.frame(disorder="Major Depressive Disorder"), fun = dnorm, geom = "area", xlim = c(qnorm(1 - 0.15), 5), fill = "lightblue") +
  geom_vline(aes(xintercept = qnorm(1 - k))) +
  geom_hline(yintercept = 0) +
  geom_text(aes(label = str_glue("K = {k}"), x=qnorm(1 - k)+0.5), y= 0.3, hjust = "left") +
  scale_y_continuous("Probability Density") +
  scale_x_continuous("Liability", lim = c(-5, 5)) + 
  facet_grid(cols = vars(disorder)) +
  theme_classic(base_size = base_size())

```


:::{.notes}
Represents how much more likely a person is to be affected by a disorder given that a relative is affected, compared to someone from the general population.
:::

## 

Example:

- $K_\mathrm{sib} = P(\mathrm{affected} | \mathrm{sibling\ affected}) = 0.09$
- $K = P(\mathrm{affected\ in\ population}) = 0.02$
- $\frac{K_\mathrm{sib}}{K} = \frac{0.09}{0.02} = 4.5$

## Recurrance risk for schizophrenia

```{r}
#| label: scz_rr
#| echo: false
require(readr)
require(ggplot2)

scz_rr <- read_csv(here::here("data/lichtenstein-scz/lichtenstein-scz.csv"))

ggplot(scz_rr, aes(x = factor(Relationship, levels = rev(Relationship)), y = `Relative Risk`, ymin = l95, ymax = u95)) +
  geom_pointrange() +
  scale_x_discrete("") +
  scale_y_continuous(breaks = 1:12) +
  coord_flip(ylim = c(1, 12)) +
  theme_classic(base_size = base_size())

```

:::{.notes}
Recurrance risk to relatives for schizophrenia in Sweden, which has a baseline risk of $K = 0.47$%.

Lichtenstein, P. et al. Recurrence risks for schizophrenia in a Swedish National Cohort. Psychol. Med. 36, 1417‚Äì1425 (2006). doi:[10.1017/s0033291706008385](https://dx.doi.org/10.1017/s0033291706008385)
  
:::

## Recurrance risk and heritability

- Score $\mathrm{unaffected} = 0, \mathrm{affected} = 1$
- If population prevalence is $K$, then phenotypic variance is $V_\mathrm{P} = K(1-K)$ (Bernoulli distribution)


##

- $Y$ = score of individual (proband)
- $Y_\mathrm{R}$ = score of relative of proband
- Expectation: $E[Y] = E[Y_\mathrm{R}] = K$
- $K_\mathrm{R} = E[Y_\mathrm{R} | Y = 1]$
- Probability that both $Y$ and $Y_\mathrm{R}$ = 1: $E[YY_\mathrm{R}] = K \times K_\mathrm{R}$

$$
\mathrm{cov}(Y, Y_\mathrm{R}) = E[YY_\mathrm{R}] - E[Y] E[Y_\mathrm{R}] \\
= K \times K_\mathrm{R} - K^2 \\
$$

:::{.notes}

- James, J. W. Frequency in relatives for an all-or-none trait. Ann. Hum. Genet. 35, 47‚Äì49 (1971). doi:[10.1111/j.1469-1809.1956.tb01377.x](https://doi.org/10.1111/j.1469-1809.1956.tb01377.x)
- Risch N. Linkage strategies for genetically complex traits. I. Multilocus models. Am J Hum Genet. 1990 Feb;46(2):222-8. PMID: 2301392

:::
  
## 

::: {.content-visible unless-format="pdf"}
$$
\mathrm{cov}(Y, Y_\mathrm{R}) = E[YY_\mathrm{R}] - E[Y] E[Y_\mathrm{R}]
$$
:::

$$
= K \times K_\mathrm{R} - K^2 \\
= K(K_\mathrm{R} - K) \\
= K^2 (\frac{K_\mathrm{R}}{K} - 1) \\
= K^2 (\lambda_\mathrm{R} - 1)
$$

## Heritability estimate

$$
h^2 = \frac{\mathrm{cov}_\mathrm{R}}{\mathrm{r}V_\mathrm{P}} \\
= \frac{K^2 (\lambda_\mathrm{R} - 1)}{\mathrm{r}K(1-K)} \\
= \frac{K (\lambda_\mathrm{R} - 1)}{\mathrm{r}(1-K)} \\
$$

## Recurrance risk of psychiatric disorders

```{r}
#| label: psy_rr
#| fig-cap: "Prevalence in population (K) and with one parent affected (K[1])"
#| echo: false
require(dplyr)
require(tidyr)
require(ggplot2)

# based on data and code from https://github.com/BartBaselmans/CHARRGe
a <- 0.5
psy_k <- tribble(
  ~disorder, ~h2, ~K,
  "Schizophrenia", 0.70, 0.01,
  "Bipolar Disorder", 0.65, 0.01,
  "Major Depressive Disorder", 0.35,0.15,
  "ADHD", 0.75, 0.05, 
  "Anorexia Nervosa", 0.5, 0.01,
 "Autism Spectrum Disorder", 0.8, 0.01
) |>
  mutate(Tx = -qnorm(K, 0, 1)) |>
  mutate(z = dnorm(Tx)) |>
  mutate(i = z/K) |>
  mutate(Tx1 = (Tx - a * i * h2) / (sqrt(1 - a * a * h2 * h2 * i * (i-Tx)))) |>
  mutate(K1 = 1 - pnorm(Tx1))

psy_k1 <- psy_k |>
  select(disorder, K, K1) |>
  pivot_longer(cols = c(K, K1), names_to = "K", values_to = "prev")

ggplot(psy_k1, aes(x = K, y = 100*prev)) +
  geom_col() +
  scale_x_discrete("") +
  scale_y_continuous("Lifetime Prevalence (%)") +
  coord_flip() +
  facet_grid(rows = vars(disorder)) +
  theme_minimal(base_size = base_size()) +
  theme(strip.text.y = element_text(angle = 0))
```

:::{.notes}

Baselmans, B. M. L., Yengo, L., Rheenen, W. van & Wray, N. R. Risk in relatives, heritability, SNP-based heritability and genetic correlations in psychiatric disorders: a review. Biol Psychiat (2020) doi:10.1016/j.biopsych.2020.05.034.

:::
  

## Estimating environmental effects

Contrast pairs of relatives that have comparable environmental similarity but different genetic similarity.

::::{.columns}

:::{.column}

![](assets/Identical-fraternal-sperm-egg.svg)

:::

:::{.column}

- Monozygotic (MZ) twins $\mathrm{r} = 1.0$
- Dizygotic (DZ) twins $\mathrm{r} = 0.5$

:::

::::

:::{.notes}
[Zygote development figure](https://commons.wikimedia.org/wiki/File:Identical-fraternal-sperm-egg.svg) CC-BY-SA Trikly.
:::

## Additive genetic and shared environment effects

Add a shared ($C$ or "common") environment to the basic genetic model, to capture similarity between relatives attributable to environmental factors. $E$ represents the unique, non-shared environment.

$$P = A + C + E$$

$$h^2 = \frac{\mathrm{var}(A)}{\mathrm{var}(P)}, c^2 = \frac{\mathrm{var}(C)}{\mathrm{var}(P)}, e^2 = \frac{\mathrm{var}(E)}{\mathrm{var}(P)}$$

$$h^2 + c^2 + e^2 = 1$$

## Twin correlations

MZ twins: $r_\mathrm{MZ} = h^2 + c^2$

DZ twins: $r_\mathrm{DZ} = \frac{1}{2}h^2 + c^2$  

##

### Solve for genetic similarity ($h^2$)

Calculate difference between MZ and DZ correlations

$$
r_\mathrm{MZ} - r_\mathrm{DZ} = (h^2 + c^2) - (\frac{1}{2}h^2 + c^2)
$$

$$
r_\mathrm{MZ} - r_\mathrm{DZ} = h^2 - \frac{1}{2}h^2 + c^2 - c^2
$$

$$
r_\mathrm{MZ} - r_\mathrm{DZ} = \frac{1}{2}h^2
$$

$$
h^2 = 2(r_\mathrm{MZ} - r_\mathrm{DZ})
$$

##

Substitute $h^2$ into MZ equation and solve for shared environment similarity ($c^2$)

$$
r_\mathrm{MZ} = \underbrace{h^2} + c^2
$$

$$
r_\mathrm{MZ} = 2(r_\mathrm{MZ} - r_\mathrm{DZ}) + c^2
$$

$$
r_\mathrm{MZ} - 2(r_\mathrm{MZ} - r_\mathrm{DZ}) = c^2
$$

$$
c^2 = r_\mathrm{MZ} - 2r_\mathrm{MZ} + 2r_\mathrm{DZ}
$$

$$
c^2 = 2r_\mathrm{DZ} - r_\mathrm{MZ}
$$

## 

Therefore from MZ and DZ twin correlations we can estimate:

$$
h^2 = 2(r_\mathrm{MZ} - r_\mathrm{DZ}) \\
c^2 = 2r_\mathrm{DZ} - r_\mathrm{MZ} \\
e^2 = 1 - h^2 - c^2
$$


```{r}
#| label: twins_cor
#| fig-cap: "Visualisation with *r*[MZ] = 0.75 and *r*[DZ] = 0.5."
#| echo: false
require(tibble)
require(ggplot2)

twins_ac = tribble(
  ~Twin, ~Effect, ~Similarity,
  "MZ", "Genetic (A)", 0.5,
  "MZ", "Shared Environment (C)", 0.25,
  "DZ", "Genetic (A)", 0.25,
  "DZ", "Shared Environment (C)", 0.25,
)

ggplot(twins_ac, aes(x = Twin, y = Similarity, fill = Effect)) +
  geom_col() +
  scale_y_continuous(lim = c(0, 1), breaks=c(0, 0.25, 0.5, 0.75, 1.0)) +
  theme_minimal(base_size = base_size()) 
```

## What do we know about psychiatric genetics from twins studies

```{r}
#| label: match-class
#| echo: false
require(dplyr)
require(readr)
require(ggplot2)
require(forcats)

# data on phenotypes in twins studies
match_domain_studies <- read_csv(here::here("data/polderman-match/polderman-match-domain-nstudies.csv"))

ggplot(
  match_domain_studies,
  aes(
    x = fct_reorder(`Main Trait domain`, Nstudies),
    y = Nstudies
  )) +
  geom_col() +
  scale_x_discrete("Main Trait Domain") +
  scale_y_continuous("Number of studies") +
  coord_flip() +
  theme_minimal(base_size = base_size())

```

:::{.notes}
Polderman TJC et al.¬† [Meta-Analysis of the Heritability of Human Traits based on Fifty Years of Twin Studies](https://dx.doi.org/10.1038/ng.3285) _Nature Genetics_ doi:10.1038/ng.3285
:::

## Meta-analysis of twin heritability

```{r}
#| label: match-meta
#| fig-cap: "Meta-analysis of phenotype domains"
#| echo: false
require(dplyr)
require(readr)
require(tidyr)
require(stringr)
require(ggplot2)

match_meta <- read_csv(here::here("data/polderman-match/polderman-match-st20-meta.csv"), comment = "#")

# get full ACE estimates from wide table.
# pivot table then filter and rename variables
match_meta_full <-
match_meta |>
  pivot_longer(
    !`ICD10-ICF Chapter`,
    names_to = "estimand",
    values_to = "estimate"
  ) |>
  filter(str_detect(estimand, "^[SE_]*[A|C]FULL_all")) |>
  mutate(estimand = str_remove(estimand, "FULL_all")) |>
  separate_wider_delim(
    estimand,
    delim = "_",
    names = c("term", "component"),
    too_few = "align_end"
  ) |>
  mutate(term = if_else(is.na(term), true = 'VarProp', false = term)) |>
  filter(!is.na(estimate)) |>
  pivot_wider(names_from = term, values_from = estimate)


match_meta_full_bmh <- match_meta_full |>
  filter(
    `ICD10-ICF Chapter` %in% c(
        "Attitudes",
        "Diseases of the Nervous System",
        "Mental Functions",
        "Sensory Functions and Pain",
        "Functions of the Nervous System",
        "Mental and Behavioural Disorders"
      )
    )

ggplot(match_meta_full_bmh, aes(x = component, fill = component, y = VarProp, ymin = VarProp - SE, ymax = VarProp + SE))+
  geom_col() +
  geom_errorbar() +
  scale_x_discrete("Variance component") +
  scale_y_continuous("Variance proportion", lim = c(0, 1)) +
  coord_flip() +
  facet_grid(row = vars(fct_reorder(`ICD10-ICF Chapter`, VarProp, max))) +
  theme_minimal(base_size = base_size()) +
  theme(strip.text.y = element_text(angle = 0))  +
  guides(fill = "none")
```

:::{.notes}
Mental and behavioural disorders are on average moderately heritable with a smaller but substantial portion attributable to the shared environment.

Data from [`match.ctglab.nl`](https://match.ctglab.nl).
:::

##

```{r}
#| label: match-meta-subchapter
#| fig-cap: "Meta-analysis of psychiatric, neurological, and psychological phenotypes"
#| echo: false
require(dplyr)
require(readr)
require(tidyr)
require(stringr)
require(ggplot2)

match_meta_subchapter <- read_csv(here::here("data/polderman-match/polderman-match-st21-meta-subchapter.csv"), comment = "#")

# get full ACE estimates from wide table.
# pivot table then filter and rename variables
match_meta_subchapter_full <-
match_meta_subchapter |>
  pivot_longer(
    !`ICD-10/ICF subchapter`,
    names_to = "estimand",
    values_to = "estimate"
  ) |>
  filter(str_detect(estimand, "^[SE_]*[A|C]FULL_SS")) |>
  mutate(estimand = str_remove(estimand, "FULL_SS")) |>
  separate_wider_delim(
    estimand,
    delim = "_",
    names = c("term", "component"),
    too_few = "align_end"
  ) |>
  mutate(term = if_else(is.na(term), true = 'VarProp', false = term)) |>
  filter(!is.na(estimate)) |>
  pivot_wider(names_from = term, values_from = estimate)

match_meta_subchapter_bmh <- match_meta_subchapter_full |>
  mutate(
    ICD10 = case_match(
      `ICD-10/ICF subchapter`,
      "Recurrent Depressive Disorder" ~ "Recurrent Depression",
      "Depressive Episode" ~ "Depression",
      "Temperament and Personality Functions" ~ "Personality",
      "Eating Disorders" ~ "Eating Disorders",
      "Obsessive-Compulsive Disorder" ~ "OCD",
      "Other Anxiety Disorders" ~ "Anxiety",
      "Phobic Anxiety Disorders" ~ "Phobias",
      "Schizophrenia" ~ "Schizophrenia",
      "Bipolar Affective Disorder" ~ "Bipolar Disorder",
      "Dementia In Alzheimer Disease" ~ "Dementia"
    )
  ) |>
  filter(!is.na(ICD10))

ggplot(match_meta_subchapter_bmh, aes(x = component, fill = component, y = VarProp, ymin = VarProp - SE, ymax = VarProp + SE))+
  geom_col() +
  geom_errorbar() +
  scale_x_discrete("Variance component") +
  scale_y_continuous("Variance proportion", lim = c(-0.03, 1)) +
  coord_flip() +
  facet_grid(row = vars(fct_reorder(ICD10, VarProp, max))) +
  theme_minimal(base_size = base_size()) +
  theme(strip.text.y = element_text(angle = 0)) +
  guides(fill = "none")
```

# Genetics of depression and schizophrenia

## Major depressive disorder (MDD)

- 1+ in 10 affected 
- 7-11 years of life are lost
- Global cause of ill-health

## MDD diagnostic criteria {.smaller}

1 of the 2 **cardinal** symptoms with 5 symptoms in total:

1. **Low mood**
2. **Anhedonia**
3. Increase or decrease in weight or appetite
4. Insomnia or hypersomnia
5. Psychomotor agitation or slowing
6. Fatigue 
7. Feelings of worthlessness/guilt
8. Concentration problems
9. Suicidal ideation

Heterogeneous disorder: 227 possible symptom profiles.

:::{.notes}
Fried, E. I. & Nesse, R. M. Depression is not a consistent syndrome: An investigation of unique symptom patterns in the STAR*D study. J Affect Disorders 172, 96‚Äì102 (2015).
:::

## "Evidence for Multiple Genetic Factors Underlying DSM-IV Criteria for Major Depression"

```{mermaid twin_pairs_mdd}
flowchart LR
  twins["7500 twin pairs"]
  screen{"Screen
  cardinal
  symptoms"}
  endorse["3671 endorsed"]
  denied["3829 denied"]
  symptoms("Symptoms assessed")
  twins --> screen
  screen --> endorse
  screen --> denied
  endorse --> symptoms
```

:::{.notes}
Kendler, K. S., Aggen, S. H. & Neale, M. C. Evidence for Multiple Genetic Factors Underlying DSM-IV Criteria for Major Depression. JAMA Psychiat 70, 599‚Äì607 (2013).
:::

## Multivariate twin model

- analysed MZ and DZ twin cross-correlations among depression symptoms
- tested 1, 2, or 3 factor models of genetic, shared environment, and unique environment

## Best fit model {.smaller}

**Genetic factors**

1. Psychomotor/cognitive symptoms (psychomotor, guilt, concentration, suicidality)
2. Mood symptoms (low mood, anhedonia)
3. Neurovegetative symptoms (weight, sleep, fatigue)

**Individual-specific (unique) environment factors**

1. General depression (low mood, anhedonia, weight, sleep, psychomotor, fatigue, concentration)
2. Mood symptoms (low mood, anhedonia, concentration)
3. Cognitive symptoms (guilt, suicidality)

## External validators of genetic factor scores {.smaller}

|Validator variable|Cognitive/Motor|Core Mood|Neurovegetative|
|------------------|--------------:|--------:|--------------:|
|Neuroticism        | **0.54**      |**0.27** |**0.30**       |
|Anxiety disorder   | **0.77**      | **0.49**| **0.47**      |
|Age at onset       | **-3.00**     | -1.15   | 0.37          |
|No. of episodes    | **0.55**      | 0.16    | **0.23**      |
|Melancholia subtype| **1.05**      |**-0.43**| **1.34**      |
|Unreactive mood    | **0.82**      | 0.10    | **0.79**      |

: Data from Table 4 Kendler, Aggen, & Neale. **_p_ < 0.001**

:::{.notes}
Cognitive/Motor factor associated with non-specific liability to internalising disorders  
Neurovegetative factor most strongly related to Melancholic subtype more specific to major depression
:::


## Schizophrenia diagnostic criteria

At least one **core** symptom and two or more symptoms present for a significant period of time

1. **Delusions**
2. **Hallucinations**
3. **Disorganised speech**
4. Grossly disorganised or catatonic behaviour
5. Negative symptoms 

:::{.notes}
Negative symptoms encompass deficiencies in emotional life, motivations, thinking, and relationships
:::

## Schizophrenia risk factors

![](assets/pmed.0020212.g001.PNG_L.png)

:::{.notes}
Compare environmental risk factors to family history.

Figure CC-BY Sullivan PF (2005) The Genetics of Schizophrenia. PLoS Med 2(7): e212. doi:[10.1371/journal.pmed.0020212](https://doi.org/10.1371/journal.pmed.0020212).
:::

# Why is $h^2$ the symbol for heritability?

##

![](assets/wright-guinea-pigs-h.png)

:::{.notes}
$h$ for *h*eritability makes sense, but why the squared term?

Sewall Wright was a geneticist who studied population and evolutionary genetics and developed path analysis. In a path diagram of genetic, segregation, developmental and environmental effects, the symbol $h$ was used as the correlation between an individual's genome and their phenotype. If the path weights are standardised, then $h^2$ represents the proportion of variance in the phenotype attributable to genetics. 

Wright, S. The relative importance of heredity and environment in determining the piebald pattern of guinea-pigs. PNAS 1920. doi:[10.1073/pnas.6.6.320](https://doi.org/10.1073/pnas.6.6.320).
:::